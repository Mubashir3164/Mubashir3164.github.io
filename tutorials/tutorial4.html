<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BWA Tutorial - Aligning Sequenced Reads to Reference Genome</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background: #333;
            color: white;
            text-align: center;
            padding: 1em 0;
        }
        .container {
            width: 80%;
            margin: 20px auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
        }
        h2 {
            color: #444;
        }
        p {
            font-size: 1.1em;
            color: #555;
        }
        code {
            font-family: monospace;
            background-color: #f9f9f9;
            padding: 5px;
            border-radius: 4px;
        }
        pre {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
        }
        .note {
            background-color: #fffae6;
            border-left: 4px solid #ffcc00;
            padding: 10px;
            margin-bottom: 20px;
        }
        a {
            color: #0077cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        footer {
            text-align: center;
            padding: 1em 0;
            background-color: #333;
            color: white;
            margin-top: 40px;
        }
        .button {
            background-color: #0077cc;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
        }
        .button:hover {
            background-color: #005fa3;
        }
    </style>
</head>
<body>

<header>
    <h1>Burrow-Wheeler-Aligner (BWA) Tutorial</h1>
    <p>Using BWA to Align Sequenced Reads to Reference Genome</p>
</header>

<div class="container">
    <section>
        <h2>Introduction</h2>
        <p>BWA maps DNA sequences to a large reference genome, such as human or plant genomes. There are different algorithms in BWA:</p>
        <ul>
            <li><strong>BWA-backtrack</strong> - Best for aligning Illumina reads of up to 100bp.</li>
            <li><strong>BWA-SW</strong> - For longer reads, from 70bp to Megabases.</li>
            <li><strong>BWA-MEM</strong> - For longer reads (better suited for most sequencing platforms).</li>
        </ul>
        <p>You can download BWA and Picard tools from the following links:</p>
        <ul>
            <li><a href="https://sourceforge.net/projects/bio-bwa/files/">BWA (SourceForge)</a></li>
            <li><a href="https://github.com/lh3/bwa">BWA (GitHub)</a></li>
            <li><a href="https://github.com/broadinstitute/picard/releases/tag/2.27.4">Picard Tools</a></li>
        </ul>
    </section>

    <section>
        <h2>Setting Up Directories</h2>
        <p>Create three directories to organize the necessary files:</p>
        <pre><code>mkdir Ref_genome # for reference genome</code></pre>
        <pre><code>mkdir FastqFiles # for raw fastq files</code></pre>
        <pre><code>mkdir BamFiles # for BWA output files</code></pre>
    </section>

    <section>
        <h2>Processing the Reference Genome</h2>
        <p>To prepare the reference genome for alignment, you need to index it. Run the following command to index the reference genome:</p>
        <pre><code>bwa index -p Ref_genome/your_ref.genome</code></pre>
        <p>After running this command, several index files will be created in the <code>Ref_genome</code> directory.</p>
    </section>

    <section>
        <h2>Aligning Reads to the Reference Genome</h2>
        <p>If you have multiple paired-end reads like:</p>
        <pre><code>SRR1.1.fastq.gz SRR1.2.fastq.gz SRR2.1.fastq.gz SRR2.2.fastq.gz ...</code></pre>
        <p>Use the following loop to align them using BWA-MEM:</p>
        <pre><code>for INDEX in 1 2 3 4;
do
    bwa mem -M -t 8 -R "@RG\tID:COL_${INDEX}\tSM:COL_${INDEX}" Ref_genome/genome.Garb.CRI.fa \
    FastqFiles/SRR${INDEX}.1.fastq.gz \
    FastqFiles/SRR${INDEX}.2.fastq.gz \
    > BamFiles/SRR${INDEX}.sam
done</code></pre>
        <div class="note">
            <strong>Note:</strong> The <code>@RG</code> field refers to read groups, which are collections of reads from a single sequencing run. This information helps in distinguishing between samples and specific sequenced samples across different experiments. It is required by tools like GATK to account for variability across sequencing runs.
        </div>
    </section>

    <section>
        <h2>Converting SAM Files to BAM</h2>
        <p>After BWA alignment, you will get SAM files. To convert these into BAM files, which are more efficient for downstream processing, run the following command:</p>
        <pre><code>for INDEX in {1..4};
do
    picard SortSam \
    I=BamFiles/SRR${INDEX}.sam \
    O=BamFiles/SRR${INDEX}.sorted.bam \
    SORT_ORDER=coordinate \
    CREATE_INDEX=true
done</code></pre>
    </section>

    <section>
        <h2>Building BAM Index</h2>
        <p>Next, create an index for the BAM files so that downstream programs can quickly access their contents:</p>
        <pre><code>for INDEX in {1..4}
do
    picard BuildBamIndex \
    I=BamFiles/SRR${INDEX}.sorted.bam
done</code></pre>
    </section>

    <section>
        <h2>References</h2>
        <p>For more information on BWA, visit the official manual:</p>
        <p><a href="http://bio-bwa.sourceforge.net/bwa.shtml" target="_blank">BWA Manual</a></p>
        <p>Primary reference:</p>
        <p>Li H, Durbin R. Fast and accurate short read alignment with Burrows-Wheeler transform. Bioinformatics. 2009 Jul 15;25(14):1754-60. doi: 10.1093/bioinformatics/btp324. Epub 2009 May 18. PMID: 19451168; PMCID: PMC2705234.</p>
    </section>
</div>

<footer>
    <p>&copy; 2025 <a href="https://mubashir3164.github.io/" class="button">Visit My Website</a></p>
</footer>

</body>
</html>
